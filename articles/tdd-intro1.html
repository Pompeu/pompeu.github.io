<!DOCTYPE html><html lang="pt-br"><head><title>Blog Limp</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0"/><meta name="description" content="Blog e Página pessoal, de um estudante e desenvolvedor, com foco em algoritmos, programação funcional e principalmente performance com uma pegada que busca interação entre academia e mercado, C/C++,  Java , Javascritp(nodeJS) e Python são as principais tecnologias abordadas."/><link rel="stylesheet" href="/stylus/style.css"/><link rel="icon" href="/images/favicon.ico"/></head><body><header class="header"><div class="design-by"><a href="https://twitter.com/EulerGotardo" target="_blank">Design by @EulerGotardo</a></div><a href="/"><div class="mini-menu"></div></a><a href="/"><div class="header-img"></div></a><h2 class="heading">Web Developer, Brasilian jiujitsu Fighter and Student<a href="#inicio" role="button"><div class="down-img"></div></a><main class="heading-menu"><a href="/" class="heading-menu-li">Posts</a><span class="heading-menu-li-separetor">|</span><a href="/tutoriais" class="heading-menu-li">Tutoriais</a><span class="heading-menu-li-separetor">|</span><a href="/about" class="heading-menu-li">About</a></main></h2></header><div class="social-cont"><div class="social-img"><a href="https://twitter.com/Pompeulimp" class="img-twitter"></a><a href="https://www.youtube.com/channel/UCvSz51aSjjMNJ-L522hJUJg" class="img-youtube"></a><a href="https://www.facebook.com/itacir.pompeu" class="img-facebook"></a><a href="https://github.com/pompeu" class="img-github"></a></div></div><div class="search-input"><div class="styled-input"> <input id="q" type="text" required="required" autocomplete="off"/><label id="inicio" name="inicio">Buscar ...</label></div></div><div class="results"><ul id="results"></ul></div><div class="post-item"><div class="post-details"><div class="post-center"><a href="/"><button class="voltar-img tooltips"> <span class="tooltips">voltar</span><img src="/images/ic_arrow_back_48px.svg"/></button></a><br/><br/><br/><div><h1>Introdução ao TDD com NodeJS</h1><h2>Como começar</h2><ul>
<li>Verifique versão do node com  o comando node -v  na linha de comando.</li>
<li>Verifique versão do npm com npm -v.</li>
<li>Instale o mocha “sudo npm install -g mocha”.</li>
<li>Tenha certeza que está tudo instalado e continue.</li>
</ul>
<h2>Breve Introdução ao TDD (Test Drive Development)</h2><p>O TDD (Desenvolvimento Guiado por Testes) é uma metodologia de desenvolvimento, onde deve-se criar um teste antes de criar o código fonte. Com isso ganha uma série de benefícios, como um código mais limpo e simples de manter, e ao final todo seu códígo já possui uma cobertura de testes automatizados, ou seja, seu sistema nasce testado.</p>
<p>Essa metodologia também é conhecida como Vermelho, Verde e Refatorar, uma analogia à forma como um Junit trabalha. O Junit é um framework usado para criar testes unitários e automatizados em Java, a grande maioria dos frameworks criados para a atividade do TDD, segue essa regra, onde fica vermelho nas falhas e verde nos sucessos. Veja a imagem 1:</p>
<p><img src="http://tableless.com.br/wp-content/uploads/2013/12/TDD-ciclo-vermelho-verde-refatora-591x310.jpg" alt="tdd"> </p>
<p>Deve ser lembrado que o pai dessa metodologia, o grande Kent Beck, criou o TDD, o XP e o Junit, e também é um dos nomes famosos no manifesto ágil.</p>
<p><a href="https://www.youtube.com/watch?v=1zaCvLVU70o" target="”_blank”">Video Sobre Kent Back e JUNIT</a></p>
<h2>Passo 01</h2><p>Depois dessa breve introdução ao TDD, vamos começar nosso trabalho que é criar uma função que converte números romanos.</p>
<p>Crie uma pasta de nome “conversor_de_romanos”, e nela crie outras duas sub-pastas, models e testes.
A pasta models terá um arquivo com a função de converter os números romanos em números naturais e a pasta de testes terá o arquivo para fazer o testes. Pois bem, vamos conhecer nossa tarefa.</p>
<p>Nossa tarefa consiste em passar um valor romano para uma função, e ela retornar seu valor em número arábico como resposta. Pois bem, vamos conhecer a tabela de números romanos.</p>
<h4>Tabela de números romanos</h4><p>  <b>
    I  = 1 <br>
    V = 5 <br>
    X = 10 <br>
    L = 50 <br>
    C = 100 <br>
    D = 500 <br>
    M = 1000 <br>
  </b></p>
<p>A segunda etapa desse projeto é criar o primeiro teste, então vamos ao passo 02.</p>
<h2>Passo 02</h2><p>Dentro da pasta testes, crie um arquivo com o nome conversor-romanos.spec.js. Feito isso, vamos criar o primeiro teste de acordo com a Test 1. Perceba que será usado o módulo assert, ele é nativo do node, e sua função é validar os resultados da execução da função. A api do assert pode ser consultada em :  <a href="”https://nodejs.org/api/assert.html”"> API Assert Node </a>.</p>
<h3>Test 1</h3><pre><code class="language-js">
&#39;use strict&#39;;
const assert = require(&#39;assert&#39;);

describe(&#39;testing module conversor de romanos&#39;, () =&gt; {

  const Conversor = require(&#39;./models/conversor-romanos&#39;);

  describe(&#39;testes da função converte&#39;, () =&gt; {

    it( &#39;deve entender  o simbolo I &#39;, done =&gt; {
      let conversor = Conversor.converte(&quot;I&quot;);
      assert.equal(1 , conversor);
      done();
    });

  });
});
</code></pre>
<h2>Rodando o Tests</h2><p>Para rodar o teste vamos usar o mocha que foi instalado globalmente, usaremos  o comando :</p>
<pre><code>  mocha conversor-romanos.spect.js
</code></pre><p>Feito isso, deverá aparecer uma mensagem de erro, pois ainda não criamos o módulo conversor-de-romanos.js na pasta models, e esse é o momento de criá-lo e nele fazer a implementação mais simples possível para que o teste passe e fique verde bem rápido.</p>
<p>Com o arquivo criado, vamos implementar esse módulo criando a função converte(), de modo que ela  possa retornar o número 1, no código 2 pode ser vista essa implementação, verifique ela é muito simples.</p>
<h4>Código 2</h4><pre><code class="language-js">‘use strict’;

/*
   um detalhe sobre esse módulo é que ele já exporta a função executada,
   ou seja, podemos usar a função converte (arg);
   que é um serviço exportado pelo módulo conversor.
*/

module.exports = conversor();

function  conversor() {
  let service = {
    converte : converte;
  };

  return service;
  // essa abordagem é a mais simples possível
  // conhecida como baby steps, termo cunhado pelo criador do TDD/XP Kent Beck
  function  converte (romanNumber) {
    if(romanNumber === &#39;I&#39;) return 1;
  }

}
</code></pre>
<p>Agora chegou a hora de rodar novamente o teste e verificar seu resultado :</p>
<pre><code>mocha conversor-romanos.spect.js
</code></pre><pre class="”green”">
  <span> ✓ </span> deve entender  o simbolo I
</pre>

<p>E agora que o teste passou, já sabemos como converter o romano I para valor 1. Vamos para o próximo teste?</p>
<h2>Passo 3</h2><p>Criando um teste para o valor V, ele deverá retornar o valor 5. Dentro do arquivo de teste, na função describe logo após o primeiro teste, implemente o código 2.</p>
<h3>Test 2</h3><pre><code class="language-js">
   it( &#39;deve entender  o simbolo V &#39;, done =&gt; {
      let conversor = Conversor.converte(&quot;V&quot;);
      assert.equal(5 , conversor);
      done();
   });
</code></pre>
<p>Dando continuidade, rode o mocha novamente e o teste deverá falhar, pois não foi feita a implementação da função converte para que ela entenda o valor V.</p>
<p>Vamos fazer essa implementação seguindo sempre pela forma mais simples possível, ou seja, a função deverá ter um if que retorne o valor 5 para o caso da entrada V.</p>
<pre><code class="language-js">
  function  converte (romanNumber) {
    if(romanNumber === &#39;I&#39;) return 1;
    else if(romanNumber === &#39;V&#39;) return 5;
  }
</code></pre>
<p>Rode o teste, ele deverá passar. </p>
<pre><code>mocha conversor-romanos.spect.js
</code></pre><pre class="”green”">
   <span> ✓ </span>  deve entender  o símbolo I
   <span> ✓ </span>  deve entender  o símbolo V
</pre>


<p>Essa é portanto, a primeira parte da introdução, nosso conversor de romanos até o momento consegue converter dois valores, porém esse é o momento de dar um passo maior, pois em um sistema criar if e else if para tudo não é uma boa prática.</p>
<p>Como vamos resolver esse problema, nos conhecemos todos os números romanos, ok? que estão listados na nossa tabela. Pois bem, vamos criar um Mapa (Map) e nele vamos adicionar as chaves e valores, porém antes vamos criar mais 1 teste, para o valor M que deverá retornar 1000.</p>
<h3>Teste 3</h3><pre><code class="language-js">
   it( &#39;deve entender  o simbolo M &#39;, done =&gt; {
      let conversor = Conversor.converte(&quot;M&quot;);
      assert.equal(1000 , conversor);
      done();
   });
</code></pre>
<p>Siga os passos anteriores, rode o mocha, veja o teste falhar, em seguida verifique como ficou a implmentação do arquivo de modelo, nele foi usado Map para guardar os números romanos de uma forma mais estruturada.</p>
<pre><code class="language-js">
module.exports = conversor();

/*
  criando um mapa para valores romanos
  onde sua chave é o valor em romano
  e seu valor e um número arábico correspondente
*/

let map =  new Map();
// set(CHAVE, VALOR);
map.set(&quot;I&quot;, 1);
map.set(&quot;V&quot;, 5);
map.set(&quot;X&quot;, 10);
map.set(&quot;L&quot;, 50);
map.set(&quot;C&quot;, 100);
map.set(&quot;D&quot;, 500);
map.set(&quot;M&quot;, 1000);


function  conversor() {

  let service = {
    converte : converte;
  };

  return service;
  /*
    implementação nova da função converte,
    onde ele pega um número romano, faz a 
    consulta no map usando sua chave e 
    nos devolve um valor.
  */
  function  converte (romanNumber) {
    //get recebe uma chave e retorna um valor
    return map.get(romanNumber);
  }

}
</code></pre>
<p>Agora rodando o mocha, deverá ser vista a seguinte tela no seu terminal, onde todos os testes passaram.</p>
<pre class="”green”">
  <span> ✓ </span> deve entender o símbolo I 
  <span> ✓ </span> deve entender o símbolo V 
  <span> ✓ </span> deve entender o símbolo M
</pre>

<p>Esse foi o final da parte 1 do tutorial de introdução ao TDD, esse exemplo foi tirado do livro TDD no mundo real, do grande Maurício Aniche, que é hoje na minha humilde opnião uma das maiores referências de TDD no mundo acadêmico, ele fez seu mestrado e agora faz doutorado sobre o assunto, tambem é professor na Caelum, ou seja, vale a pena seguir esse cara para quem quer aprofundar no assunto.</p>
<p>Se você quer aprender mais sobre TDD usando nodeJS, não deixe de ver a continuação dessa série, e faça o curso Be Mean da WebSchool, onde eu serei o responsável pela parte de testes automatizados do curso. Um ótimo local para ler e aprender sobre TDD é o blog do Maurício Anishe <a href="http://www.aniche.com.br/tdd/"> link </a>.</p>
<p>Vamos para a segunda parte do tutorial? <a href="tdd-intro2" target="_blank"> “Click Aqui&quot; </a></p></div><div class="compartilhar"><h1>Compartilhe</h1><div class="icon"><a href="https://www.facebook.com/sharer/sharer.php?u=http://pompeu.github.io/articles/tdd-intro1" onclick="window.open(this.href, 'facebook-share','width=550,height=235');return false;" class="face-icon tooltips"><span class="tooltips">Facebook</span><img src="/images/facebook-icon.svg"/></a><a href="https://twitter.com/intent/tweet?url=http://pompeu.github.io/articles/tdd-intro1&amp;text=O desenvolvimento guiado por testes, e um cartucho deve estar no seu arsenal, ele de fato é uma metodologia muito atual e usada, pode ajudar na refatoraçao de codígo legado, pode encurtar caminhos para  contribuir para projetos opensource e claro deixar seus sistemas, simples e faceis de manter com codígos mais limpos.&amp;via=Pompeulimp" onclick="window.open(this.href, 'twitter-share','width=550,height=235');return false;" class="twitter-icon tooltips"> <span class="tooltips">Twitter</span><img src="/images/twitter-icon.svg"/></a><a href="https://plus.google.com/share?url=http://pompeu.github.io/articles/tdd-intro1" onclick="window.open(this.href, 'google-plus-share','width=550,height=235');return false;" class="google-icon tooltips"> <span class="tooltips">Google Plus</span><img src="/images/google-plus-icon.svg"/></a></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'pompeublog';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-53520427-1', 'auto');
 ga('send', 'pageview');</script><footer class="footer"><h2 class="footer-title">Pompeu - 2015</h2></footer><script src="/js/bower_components/rxjs/dist/rx.all.min.js"></script><script src="/js/bower_components/rxjs-dom/dist/rx.dom.js"></script><script src="/js/app.js"></script></body></html>